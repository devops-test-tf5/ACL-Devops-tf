<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
	xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:pro="http://www.liquibase.org/xml/ns/pro"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.1.xsd
      http://www.liquibase.org/xml/ns/pro 
      http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.1.xsd">

	<changeSet author="acldigital" id="1">
		<createTable tableName="status_master">
			<column name="status_id" type="INTEGER" autoIncrement="true">
				<constraints nullable="false" primaryKey="true"
					unique="true" />
			</column>
			<column name="status_name" type="VARCHAR(50)" />
			<column name="active" type="CHAR(1)" defaultValue="Y" />
			<column name="created_by" type="VARCHAR(50)"
				defaultValue="ADMIN" />
			<column name="created_date" type="TIMESTAMP"
				defaultValue="NULL" />
			<column name="updated_by" type="VARCHAR(50)"
				defaultValue="ADMIN" />
			<column name="updated_date" type="TIMESTAMP"
				defaultValue="NULL" />
		</createTable>

		<createTable tableName="roles">
			<column name="role_id" type="INTEGER" autoIncrement="true">
				<constraints nullable="false" primaryKey="true"
					unique="true" />
			</column>
			<column name="role_name" type="VARCHAR(50)">
				<constraints nullable="false" />
			</column>
			<column name="is_active" type="TINYINT" defaultValue="1" />
			<column name="created_by" type="VARCHAR(50)"
				defaultValue="ADMIN" />
			<column name="created_date" type="TIMESTAMP"
				defaultValue="NULL" />
			<column name="updated_by" type="VARCHAR(50)"
				defaultValue="ADMIN" />
			<column name="updated_date" type="TIMESTAMP"
				defaultValue="NULL" />
		</createTable>
		<createTable tableName="users">
			<column name="user_id" type="INTEGER" autoIncrement="true">
				<constraints nullable="false" primaryKey="true"
					unique="true" />
			</column>
			<column name="role_id" type="INTEGER">
				<constraints nullable="false" />
			</column>
			<column name="user_name" type="VARCHAR(50)">
				<constraints unique="true" />
			</column>
			<column name="first_name" type="VARCHAR(50)" />
			<column name="last_name" type="VARCHAR(50)" />
			<column name="password" type="VARCHAR(200)" />
			<column name="contact_number" type="VARCHAR(50)" />
			<column name="email" type="VARCHAR(50)">
				<constraints unique="true" />
			</column>
			<column name="is_active" type="TINYINT" defaultValue="1" />
			<column name="location" type="VARCHAR(50)" />
			<column name="verification_code" type="VARCHAR(64)" />
			<column name="max_wrong_password_count" type="INTEGER"
				defaultValue="0" />
			<column name="wrong_password_count" type="INTEGER"
				defaultValue="0" />
			<column name="created_by" type="VARCHAR(50)"
				defaultValue="ADMIN" />
			<column name="created_date" type="TIMESTAMP"
				defaultValue="NULL" />
			<column name="updated_by" type="VARCHAR(50)"
				defaultValue="ADMIN" />
			<column name="updated_date" type="TIMESTAMP"
				defaultValue="NULL" />
		</createTable>
		<addForeignKeyConstraint
			constraintName="USERS_ROLES" referencedTableName="roles"
			baseColumnNames="role_id" baseTableName="users"
			referencedColumnNames="role_id" />

		<createTable tableName="customers">
			<column name="customer_id" type="INTEGER" autoIncrement="true">
				<constraints nullable="false" primaryKey="true"
					unique="true" />
			</column>
			<column name="user_id" type="INTEGER">
				<constraints nullable="false" />
			</column>
			<column name="customer_name" type="VARCHAR(50)" />
			<column name="location" type="VARCHAR(50)" />
			<column name="spoc_first_name" type="VARCHAR(50)" />
			<column name="spoc_last_name" type="VARCHAR(50)" />
			<column name="email" type="VARCHAR(50)" />
			<column name="is_active" type="INTEGER" defaultValue="1" />
			<column name="created_by" type="VARCHAR(50)"
				defaultValue="ADMIN" />
			<column name="created_date" type="TIMESTAMP"
				defaultValue="NULL" />
			<column name="updated_by" type="VARCHAR(50)"
				defaultValue="ADMIN" />
			<column name="updated_date" type="TIMESTAMP"
				defaultValue="NULL" />
		</createTable>
		<addForeignKeyConstraint
			constraintName="CUSTOMER_USER" referencedTableName="users"
			baseColumnNames="user_id" baseTableName="customers"
			referencedColumnNames="user_id" />

		<createTable tableName="projects">
			<column name="project_id" type="INTEGER" autoIncrement="true">
				<constraints nullable="false" primaryKey="true"
					unique="true" />
			</column>
			<column name="status_id" type="INTEGER">
				<constraints nullable="false" />
			</column>
			<column name="project_name" type="VARCHAR(100)" />
			<column name="customer_id" type="INTEGER">
				<constraints nullable="false" />
			</column>
			<column name="description" type="VARCHAR(200)" />
			<column name="start_date" type="TIMESTAMP" />
			<column name="end_date" type="TIMESTAMP" />
			<column name="duration" type="VARCHAR(50)" />
			<column name="drivers" type="JSON" />
			<column name="scope" type="JSON" />
			<column name="created_by" type="VARCHAR(50)"
				defaultValue="ADMIN" />
			<column name="created_date" type="TIMESTAMP"
				defaultValue="NULL" />
			<column name="updated_by" type="VARCHAR(50)"
				defaultValue="ADMIN" />
			<column name="updated_date" type="TIMESTAMP"
				defaultValue="NULL" />
		</createTable>
		<addForeignKeyConstraint
			constraintName="PROJECT_CUSTOMER" referencedTableName="customers"
			baseColumnNames="customer_id" baseTableName="projects"
			referencedColumnNames="customer_id" />
		<addForeignKeyConstraint
			constraintName="PROJECT_STATUS" referencedTableName="status_master"
			baseColumnNames="status_id" baseTableName="projects"
			referencedColumnNames="status_id" />

		<createTable tableName="project_team">
			<column name="onboarding_id" type="INTEGER"
				autoIncrement="true">
				<constraints nullable="false" primaryKey="true"
					unique="true" />
			</column>
			<column name="project_id" type="INTEGER">
			</column>
			<column name="created_by" type="VARCHAR(50)"
				defaultValue="ADMIN" />
			<column name="created_date" type="TIMESTAMP"
				defaultValue="NULL" />
			<column name="updated_by" type="VARCHAR(50)"
				defaultValue="ADMIN" />
			<column name="updated_date" type="TIMESTAMP"
				defaultValue="NULL" />
		</createTable>
		<addForeignKeyConstraint
			constraintName="PROJTEAM_PROJECT" referencedTableName="projects"
			baseColumnNames="project_id" baseTableName="project_team"
			referencedColumnNames="project_id" />

		<createTable tableName="workflow_mgmt">
			<column name="workflow_id" type="INTEGER" autoIncrement="true">
				<constraints nullable="false" primaryKey="true"
					unique="true" />
			</column>
			<column name="project_id" type="INTEGER">
				<constraints nullable="false" />
			</column>
			<column name="workflow_from" type="VARCHAR(50)" />
			<column name="workflow_TO" type="VARCHAR(50)" />
			<column name="message" type="VARCHAR(50)" />
			<column name="created_by" type="VARCHAR(50)"
				defaultValue="ADMIN" />
			<column name="created_date" type="TIMESTAMP"
				defaultValue="NULL" />
			<column name="updated_by" type="VARCHAR(50)"
				defaultValue="ADMIN" />
			<column name="updated_date" type="TIMESTAMP"
				defaultValue="NULL" />
		</createTable>
		<addForeignKeyConstraint
			constraintName="WORKFLOW_PROJECT" referencedTableName="projects"
			baseColumnNames="project_id" baseTableName="workflow_mgmt"
			referencedColumnNames="project_id" />

		<createTable tableName="activity_plan">
			<column name="activity_id" type="INTEGER" autoIncrement="true">
				<constraints nullable="false" primaryKey="true"
					unique="true" />
			</column>
			<column name="project_id" type="INTEGER">
				<constraints nullable="false" />
			</column>
			<column name="activities" type="VARCHAR(100)" />
			<column name="week" type="VARCHAR(100)" />
			<column name="created_by" type="VARCHAR(50)"
				defaultValue="ADMIN" />
			<column name="created_date" type="TIMESTAMP"
				defaultValue="NULL" />
			<column name="updated_by" type="VARCHAR(50)"
				defaultValue="ADMIN" />
			<column name="updated_date" type="TIMESTAMP"
				defaultValue="NULL" />
		</createTable>
		<addForeignKeyConstraint
			constraintName="ACTIVITY_PROJECT" referencedTableName="projects"
			baseColumnNames="project_id" baseTableName="activity_plan"
			referencedColumnNames="project_id" />

		<createTable tableName="resource_plan">
			<column name="resource_id" type="INTEGER" autoIncrement="true">
				<constraints nullable="false" primaryKey="true"
					unique="true" />
			</column>
			<column name="project_id" type="INTEGER">
				<constraints nullable="false" />
			</column>
			<column name="resource_name" type="VARCHAR(100)" />
			<column name="number_of_resources" type="INTEGER"
				defaultValue="0" />
			<column name="created_by" type="VARCHAR(50)"
				defaultValue="ADMIN" />
			<column name="created_date" type="TIMESTAMP"
				defaultValue="NULL" />
			<column name="updated_by" type="VARCHAR(50)"
				defaultValue="ADMIN" />
			<column name="updated_date" type="TIMESTAMP"
				defaultValue="NULL" />
		</createTable>

		<createTable tableName="email_server_config">
			<column name="email_config_id" type="INTEGER"
				autoIncrement="true">
				<constraints nullable="false" primaryKey="true"
					unique="true" />
			</column>
			<column name="config_name" type="VARCHAR(100)" />
			<column name="config_value" type="VARCHAR(100)" />
			<column name="config_desc" type="VARCHAR(100)" />
			<column name="created_by" type="VARCHAR(50)"
				defaultValue="ADMIN" />
			<column name="created_date" type="TIMESTAMP"
				defaultValue="NULL" />
			<column name="updated_by" type="VARCHAR(50)"
				defaultValue="ADMIN" />
			<column name="updated_date" type="TIMESTAMP"
				defaultValue="NULL" />
		</createTable>


		<createTable tableName="communication_template_master">
			<column name="comm_template_id" type="INTEGER"
				autoIncrement="true">
				<constraints nullable="false" primaryKey="true"
					unique="true" />
			</column>
			<column name="comm_template_type" type="VARCHAR(50)" />
			<column name="template_name" type="VARCHAR(100)" />
			<column name="subject_line" type="VARCHAR(100)" />
			<column name="template_body" type="TEXT" />
			<column name="is_active" type="CHAR(1)" defaultValue="Y" />
			<column name="created_by" type="VARCHAR(50)"
				defaultValue="ADMIN" />
			<column name="created_date" type="TIMESTAMP"
				defaultValue="NULL" />
			<column name="updated_by" type="VARCHAR(50)"
				defaultValue="ADMIN" />
			<column name="updated_date" type="TIMESTAMP"
				defaultValue="NULL" />


		</createTable>
		<sqlFile path="classpath*:/data.sql" />
	</changeSet>

	<!-- <include file="/src/main/resources/changelog-v1.0.xml"/> -->
</databaseChangeLog> 